<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>අංක විද්‍යාත්මක පලාපල</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gemunu+Libre:wght@700&family=Noto+Serif+Sinhala:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #7F0000; /* Maroon */
            --secondary: #FFA500; /* Orange */
            --accent: #6A0DAD; /* Purple */
            --light: #FDF5E6; /* Cream */
            --dark: #333;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
            --light-gray: #f8f9fa;
            --border-radius: 12px;
            --box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Serif Sinhala', serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, #9c0000 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: cover;
        }

        .title {
            font-family: 'Gemunu Libre', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
            position: relative;
        }

        .content {
            padding: 30px;
        }

        .input-section {
            background: var(--light-gray);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .input-label {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
        }

        .date-input {
            font-family: 'Noto Serif Sinhala', serif;
            padding: 14px 18px;
            border: 2px solid #e1e5e9;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            width: 100%;
            max-width: 300px;
            transition: var(--transition);
            background: white;
        }

        .date-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(127, 0, 0, 0.1);
            outline: none;
        }

        .cta-button {
            font-family: 'Noto Serif Sinhala', serif;
            background: linear-gradient(to right, var(--secondary), #ff8c00);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 165, 0, 0.4);
        }

        .cta-button:active {
            transform: translateY(0);
        }

        .cta-button i {
            font-size: 1.2em;
        }

        #error-message {
            color: var(--danger);
            font-weight: bold;
            text-align: center;
            margin-top: 15px;
            min-height: 1.2em;
            padding: 10px;
            border-radius: var(--border-radius);
            background: rgba(220, 53, 69, 0.1);
        }

        #results {
            margin-top: 20px;
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition);
        }

        #results.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
        }

        .results-title {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: bold;
        }

        .dob-display {
            background: var(--light);
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: bold;
            color: var(--primary);
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (min-width: 600px) {
            .numbers-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .number-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-top: 4px solid var(--primary);
            transition: var(--transition);
        }

        .number-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        .number-card-title {
            font-size: 1.1rem;
            color: var(--dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .number-circle {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-weight: bold;
            color: white;
            font-size: 1.4rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        #destiny-num {
            background: linear-gradient(135deg, #ffd700, #ff8c00);
        }

        #personal-num {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        .description-card {
            background: linear-gradient(135deg, var(--light) 0%, #fff8e1 100%);
            border-radius: var(--border-radius);
            padding: 25px;
            margin: 25px 0;
            border-left: 5px solid var(--secondary);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .description-text {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            line-height: 1.7;
        }

        .details-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        @media (min-width: 600px) {
            .details-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--light-gray);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .detail-item:hover {
            background: #e9ecef;
        }

        .detail-label {
            font-weight: bold;
            color: var(--dark);
        }

        .detail-value {
            color: var(--primary);
            font-weight: bold;
            text-align: right;
        }

        .num-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            margin: 3px 5px;
            font-size: 0.9rem;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .friend-best { 
            background: linear-gradient(135deg, var(--success), #20c997); 
        }
        
        .friend-normal { 
            background: linear-gradient(135deg, #90ee90, #6cda6c); 
            color: #000; 
        }
        
        .enemy-worst { 
            background: linear-gradient(135deg, var(--danger), #c82333); 
        }
        
        .enemy-normal { 
            background: linear-gradient(135deg, var(--warning), #e0a800); 
            color: #000; 
        }

        .color-swatch {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-left: 8px;
            vertical-align: middle;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            border: 2px solid white;
        }

        .note {
            border-left: 4px solid var(--info);
            padding: 20px;
            margin-top: 30px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            background: rgba(23, 162, 184, 0.05);
            font-size: 0.8rem;
        }

        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e1e5e9;
            font-size: 0.9rem;
            color: #6c757d;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .print-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
        }

        .print-btn:hover {
            background: #5a0a9c;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            
            .cta-button, .print-btn {
                display: none;
            }
        }

        @media (max-width: 600px) {
            .title {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .input-section {
                padding: 20px;
            }
            
            .number-card {
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1 class="title">අංක විද්‍යාත්මක තොරතුරු සෙවීම</h1>
        </div>

        <div class="content">
            <div class="input-section">
                <div class="input-group">
                    <label for="birthdate" class="input-label">ඔබගේ උපන් දිනය තෝරන්න:</label>
                    <input type="date" id="birthdate" class="date-input">
                    <button id="calculateBtn" class="cta-button">
                        <span>සොයන්න</span>
                    </button>
                </div>
            </div>

            <div id="error-message"></div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>ගණනය වෙමින් පවතී...</p>
            </div>

            <div id="results">
                <div class="results-header">
                    <h2 class="results-title">ඔබගේ අංක විද්‍යාත්මක තොරතුරු</h2>
                    <div class="dob-display" id="dob-display"></div>
                </div>
                
                <div class="numbers-grid">
                    <div class="number-card">
                        <h3 class="number-card-title">
                            දෛව අංකය
                            <span id="destiny-num" class="number-circle"></span>
                        </h3>
                        <p>මෙම අංකය තුළින් පුද්ගලයාගේ කර්ම ශක්තිය හා දෛවීය ලක්ෂණ පිළිබඳ හඳුනාගත හැක.</p>
                    </div>
                    
                    <div class="number-card">
                        <h3 class="number-card-title">
                            පුද්ගලික අංකය
                            <span id="personal-num" class="number-circle"></span>
                        </h3>
                        <p>මෙම අංකය තුළින් පුද්ගලයාගේ චරිත ලක්ෂණ, ගතිගුණ පිළිබඳ හඳුනාගත හැක.</p>
                    </div>
                </div>

                <div class="description-card">
                    <p id="description" class="description-text"></p>
                </div>

                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">උපන් දවස</span>
                        <span class="detail-value" id="birth-day"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">උපන් මාසය</span>
                        <span class="detail-value" id="birth-month"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">මිතුරු අංක</span>
                        <span class="detail-value" id="friend-nums"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">සතුරු අංක</span>
                        <span class="detail-value" id="enemy-nums"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">අයත් වන ග්‍රහයා</span>
                        <span class="detail-value" id="planet"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">සුබ දවස</span>
                        <span class="detail-value" id="lucky-day"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">සුබ දිනයන්</span>
                        <span class="detail-value" id="lucky-dates"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">සුබ වර්ණය</span>
                        <span class="detail-value" id="lucky-color"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">සුබ වයස්</span>
                        <span class="detail-value" id="lucky-ages"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">සුබ මාස</span>
                        <span class="detail-value" id="lucky-month"></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">බාධක මාසය</span>
                        <span class="detail-value" id="obstacle-month"></span>
                    </div>
                </div>

                <div class="note">
                    <strong>සැ.යු:</strong> මෙම තොරතුරු පොදු අංක විද්‍යාත්මක විස්තර මත පදනම් වේ. මෙහි 3, 6, 9 යන අංක ලෞකික ජයග්‍රහණ සඳහා ඉතා සුබදායී වේ. 4 හා 8 යන අංක ලෞකිකත්වයෙන් තරමක් ඈත් වන ආධ්‍යාත්මික නැඹුරුවක් පවතී. 1, 2, 5 හා 7 යන අංක මධ්‍යස්ථ වේ. <b>ඔබට 4 හා 8 යන අංක හිමිව ඇත්නම් ඔබගේ උපන් මාසය හා දවස අනුව සුබ වෙනත් මිතුරු අංකයක් සුබ අංකය ලෙස යොදා ගැනීම වඩාත් යෝග්‍ය වේ.</b>
                </div>
                
            <div class="copyright">
                &copy; <span id="year"></span> Suba Namak | Astro Jayamaga
            </div>
        </div>
    </div>

    <script>
        // JavaScript Logic
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- DATA MAPS ---

            // 1. Combined Descriptions (Destiny[1-9] -> Personal[1-9])
            const descriptions = {
                1: {
                    1: "ඉතාමත් ධෛර්යවන්ත පුද්ගලයින් වේ. ජීවිතයේ ජයග්‍රහණ කරා ගමන් කරයි.",
                    2: "වාසනාවන්ත පුද්ගලයින් වේ. හිත ශක්තිමත් කර ගැනීමට උනන්දු විය යුතුයි.",
                    3: "ඉතා ප්‍රඥාවන්ත පුද්ගලයින් වේ. ඇතැම් විට තමන්ගේ රාමුවක් තුළ කටයුතු කරයි.",
                    4: "වේගවත් ගමනක නිරත වන නමුත් පසුකාලීනව සාර්ථක වේ.",
                    5: "දක්ෂ, ඥානවන්ත පුද්ගලයින් වේ. සූක්ෂම හා උපක්‍රමශීලී වේ.",
                    6: "දක්ෂ නායකයෙක් වන අතර ඉතා ආකර්ෂණීය පුද්ගලයෙක් වේ.",
                    7: "සියුම් ඉවක් පිහිටන පුද්ගලයෙක් වේ. ආගමට දහමට බොහෝ ලැදි වේ.",
                    8: "ලොකු ලැබීම් භාග්‍යයක් සතු වුවද දියුණුව තරමක් ප්‍රමාද කරයි.",
                    9: "ඉතාමත් සටන්කාමී පුද්ගලයින් වේ. ආරක්ෂක තනතුරු සඳහා ඉතාමත් සුදුසු වේ."
                },
                2: {
                    1: "අභියෝග ජයගෙන ජීවිතය සාර්ථක කර ගැනීමේ හැකියාව ඇත.",
                    2: "කුසලතාවයන්ගෙන් යුතු වුවද මානසික ශක්තියෙන් තරමක් අඩු පුද්ගලයින් වේ.",
                    3: "අධ්‍යාපනය හා උගත්කම තුළින් ජීවිතය ජය ගැනීමට සමත් වේ.",
                    4: "ජීවිත අරමුණු ජය ගැනීම සඳහා හොඳ අධිෂ්ඨානයක් ඇති කරගත යුතු වේ.",
                    5: "වාග් ශක්තියෙන් යුක්ත වේ. කතාව ප්‍රබල චරිතයක් වේ.",
                    6: "ආකර්ෂණීය වේ. හැසිරීම, කතාබහ ආදිය ආකර්ෂණීය පුද්ගලයින් වේ.",
                    7: "බොහෝ විට උපන් ගම පල නොදෙයි. විදේශයන්හි කටයුතු තුළින් සුබ පල උදාකර ගත හැක.",
                    8: "දියුණුව තරමක් ප්‍රමාද වීම සිදුවේ.",
                    9: "ජවයෙන් හා සටන්කාමී බවින් යුක්ත වේ."
                },
                3: {
                    1: "නිසැකව සාර්ථක වේ.",
                    2: "වාසනාවන්ත නමුත් පසුගාමී ගතියක් ඇත. හිත ශක්තිමත් කරගත යුතුයි.",
                    3: "ඉතා පණ්ඩිත පුද්ගලයෙක් වේ. බුද්ධිමත් හා අනම්‍ය වේ. මමත්වයෙන් කටයුතු කරයි.",
                    4: "බුද්ධිමත් වන නමුත් ඉදිරියට යාමේ දී විවිධ ගැටලු ඇති කරයි.",
                    5: "වාසනාවන්ත වේ. වචනය බලවත් පුද්ගලයින් වේ. දක්ෂ කථිකයින් විය හැක.",
                    6: "වාසනාවන්ත හා ආකර්ෂණීය පුද්ගලයන් වේ.",
                    7: "ඥාණවන්ත පුද්ගලයන් වේ. සාමාන්‍ය මිනිසුන්ට හසු නොවන කරුණු අනාවරණය කරගත හැකිවේ.",
                    8: "ප්‍රඥාව තිබුණ ද ගැටලු ඇති කරයි. ආගමට දහමට බොහෝ ලැදි පුද්ගලයින් වේ.",
                    9: "ප්‍රඥාවන්ත වේ. සටන්කාමී පුද්ගලයින් වන අතර සාර්ථක ජීවිතයක් හිමිවේ."
                },
                4: {
                    1: "අභියෝග ජයගෙන ජීවිතය සාර්ථක කර ගැනීමේ හැකියාව ඇත.",
                    2: "නිතර සිතන පුද්ගලයෙකි. ආත්ම ශක්තිය වර්ධනය කර ගැනීමට කටයුතු කළ යුතුයි.",
                    3: "තම හැසිරීම් තුළින් ජීවිත ජයග්‍රහණ ළඟාකර ගනී.",
                    4: "තරමක් අසුබදායී වේ. චිත්ත ශක්තිය වර්ධනය කරගත යුතුයි.",
                    5: "වාග් විලාසය තුළින් ජීවිත අභියෝග ජයගත හැක.",
                    6: "රූපය හෝ උපතින් ලැබූ ධනය මගින් හෝ බාධක මැඩගෙන ඉදිරියට ගමන් කරයි.",
                    7: "බොහෝ විට උපන් ගම පල නොදෙයි. විදේශයන්හි කටයුතු තුළින් සුබ පල උදාකර ගත හැක.",
                    8: "අසුබදායී විය හැක. චිත්ත ශක්තිය වර්ධනය කරගත යුතුයි.",
                    9: "බාධා මැඩගෙන නායකත්වයක් ගත හැකි චරිත නිර්මාණය වේ."
                },
                5: {
                    1: "ඉතාමත් වාසනාවන්ත චරිතයක් වන අතර ඉක්මන් සාර්ථකත්වයට පත්වේ.",
                    2: "ධනය, දේපළ ආදිය හිමිවන අතර ජීවිතය සාර්ථක කර ගනී.",
                    3: "බුද්ධිමත් චරිතයක් වන අතර ජීවිතය සාර්ථක කර ගනී.",
                    4: "ජීවිතය සාර්ථක කර ගැනීමට බාධා අභියෝගයන්ට හොඳින් මුහුණ දීමට සිදුවේ.",
                    5: "ඉතාමත් කඩිසර තැනැත්තෙකි. වේගවත් බව තරමක් පාලනය කරගත යුතුයි.",
                    6: "ආකර්ෂණීය හා වාසනාවන්ත පුද්ගලයෙකි.",
                    7: "ආගමට දහමට ලැදි වාසනාවන්ත චරිතයක් වේ.",
                    8: "දේශපාලන ක්ෂේත්‍රයට ඉතා සුබදායී වේ.",
                    9: "ආරක්ෂක අංශ වලට සුබදායී වේ."
                },
                6: {
                    1: "හොඳින් ඉදිරියට යා හැකි දක්ෂ පුද්ගලයින් වේ.",
                    2: "ගුරු වෘත්තිය හෝ සංගීත ක්ෂේත්‍රයට ලැදි කලාකරුවන් බිහිවේ.",
                    3: "ප්‍රබල චරිතයක් වන අතර ජීවිතය සාර්ථක කර ගනී.",
                    4: "බාධාවන් ඇති විය හැකි අතර ඒවා මැඩගෙන ඉදිරියට යාමේ හැකියාව ඇත.",
                    5: "අභියෝග ජයගෙන ඉදිරියට ගමන් කරයි.",
                    6: "බාධා වලින් තොරව ඉදිරියට යාමට හැකියාව පවතී. අන්තගාමී නොවිය යුතුයි.",
                    7: "අන් අයට හසු නොවන දේ හසුකර ගත හැකි හොඳ චරිත වේ. ගුප්ත චරිත විය හැක.",
                    8: "බාධා, අභියෝග ඇති විය හැක. චිත්ත ශක්තිය වර්ධනය කරගත යුතුයි.",
                    9: "ජවය, ශක්තිය හොඳින් පවතින අතර මනා පාලනයකින් සාර්ථකත්වයට පත්විය හැක."
                },
                7: {
                    1: "හොඳින් ඉදිරියට යා හැකි දක්ෂ පුද්ගලයින් වේ.",
                    2: "අන් අයගේ සහාය බලාපොරොත්තු වේ. විදේශයන්හිදී දියුණු වීමේ හැකියාව ඇත.",
                    3: "ප්‍රබල චරිතයක් වන අතර ජීවිතය සාර්ථක කරගත හැක.",
                    4: "බාධාවන් ඇති විය හැකි අතර ඒවා මැඩගෙන ඉදිරියට යා යුතු වේ.",
                    5: "අභියෝග ජයගෙන ඉදිරියට ගමන් කරයි.",
                    6: "බාධා වලින් තොරව ඉදිරියට යාමට හැකියාව පවතී.",
                    7: "බොහෝ විට ගුප්ත චරිත වේ.",
                    8: "අන් අයගේ හිත් දිනාගෙන සමාජයට හොඳ සේවයක් ඉටු කරයි.",
                    9: "මනා සංවිධාන ශක්තියක් ඇති අතර සාර්ථකත්වයට පත්විය හැක."
                },
                8: {
                    1: "බාධා මැඩගෙන ඉදිරියට යාමට හැකියාව පවතී.",
                    2: "ආගමට දහමට ලැදි වේ. විදේශගත වීමෙන් සුබ පල උදා කරගත හැක.",
                    3: "බාධා මැඩගෙන ඉදිරියට යාමේ හැකියාව පවතී. කුඩා කාලයේ තරමක් දුෂ්කරයි.",
                    4: "නිතර බාධා අභියෝගයන්ට මුහුණ දීමට සිදුවේ.",
                    5: "වාග් විලාසයෙන් බාධා මැඩගෙන ඉදිරියට යාමේ හැකියාව පවතී.",
                    6: "බාධා මැඩගෙන ඉදිරියට යාමේ හැකියාව පවතී. කුඩා කාලයේ දුෂ්කර විය හැක.",
                    7: "ආගමට දහමට ලැදි වේ. විදේශගත වීමෙන් සුබ පල උදා කරගත හැක.",
                    8: "බාධා අභියෝගයන් ඇතිවේ. දේශපාලන ක්ෂේත්‍රයට ඉතා සුබදායී වේ.",
                    9: "බාධා අභියෝග මැඩලීමට හොඳින් ශක්තිය ඇත."
                },
                9: {
                    1: "අභියෝග වලට නොසැලෙන ශක්තිමත්, සටන්කාමී චරිත බිහිවේ.",
                    2: "සමබර චරිතයක් බිහිවේ.",
                    3: "ප්‍රඥාවන්ත දක්ෂ පුද්ගලයින් වේ. රාජ්‍ය හා පරිපාලන සේවයට වඩාත් සුදුසු වේ.",
                    4: "බාධක මැඩ පවත්වා ගැනීමට තම චරිත ලක්ෂණ මනාව පාලනය කරගත යුතු වේ.",
                    5: "හොඳ වරප්‍රසාද ලැබිය හැකි දක්ෂ පුද්ගලයින් බිහිවේ.",
                    6: "නොසැලී ඉදිරියට යාමේ ශක්තිය හොඳින් පවතී. රාජ්‍ය හා පරිපාලන සේවයට වඩාත් සුදුසු වේ.",
                    7: "විදෙස්ගත වීමෙන් සුබ පල උදා කරගත හැක.",
                    8: "බාධා අභියෝග ඇතිවේ. තම චරිත ලක්ෂණ මනාව පාලනය කරගත යුතුයි.",
                    9: "කැපී පෙනෙන දරදඬු චරිත බිහිවේ. මනා ඉවසීමෙන් ජීවීතය සාර්ථක කරගත හැක."
                }
            };

            // 2. Personal Number Details
            const personalDetails = {
                1: {
                    friend: ["2*", "7"], enemy: ["6", "8"],
                    planet: "රවි", luckyDay: "ඉරිදා", luckyDates: "1, 10, 19, 28",
                    color: "තැඹිලි වර්ණය", colorHex: ["#FFA500"],
                    luckyMonth: "අප්‍රේල්*, අගෝස්තු", obstacleMonth: "ඔක්තෝබර්"
                },
                2: {
                    friend: ["1*", "7"], enemy: ["3", "8", "9"],
                    planet: "සඳු", luckyDay: "සඳුදා", luckyDates: "2, 11, 20, 29",
                    color: "සුදු, රෝස වර්ණ", colorHex: ["#FFFFFF", "#FFC0CB"],
                    luckyMonth: "මැයි*, ජූලි", obstacleMonth: "නොවැම්බර්"
                },
                3: {
                    friend: ["6", "9"], enemy: ["4*", "8"],
                    planet: "ගුරු", luckyDay: "බ්‍රහස්පතින්දා", luckyDates: "3, 12, 21, 30",
                    color: "කහ වර්ණය", colorHex: ["#FFFF00"],
                    luckyMonth: "මාර්තු, ජූලි*, දෙසැම්බර්", obstacleMonth: "ජනවාරි"
                },
                4: {
                    friend: ["8*"], enemy: ["3*", "9"],
                    planet: "රාහු", luckyDay: "ඉරිදා", luckyDates: "1, 10, 19, 28",
                    color: "තැඹිලි, රිදී වර්ණ", colorHex: ["#FFA500", "#C0C0C0"],
                    luckyMonth: "අප්‍රේල්*", obstacleMonth: "ඔක්තෝබර්"
                },
                5: {
                    friend: ["2", "6*", "7"], enemy: ["4", "8"],
                    planet: "බුධ", luckyDay: "බදාදා", luckyDates: "5, 14, 23",
                    color: "කොළ වර්ණය", colorHex: ["#008000"],
                    luckyMonth: "සැප්තැම්බර්*, ජුනි", obstacleMonth: "මාර්තු"
                },
                6: {
                    friend: ["3*", "9"], enemy: ["4", "8*"],
                    planet: "සිකුරු", luckyDay: "සිකුරාදා", luckyDates: "6, 15, 24",
                    color: "නිල් වර්ණය", colorHex: ["#0000FF"],
                    luckyMonth: "මාර්තු*, මැයි, ඔක්තෝබර්", obstacleMonth: "අගෝස්තු"
                },
                7: {
                    friend: ["2*", "5"], enemy: ["6", "8"],
                    planet: "කේතු", luckyDay: "සඳුදා", luckyDates: "7, 16, 25",
                    color: "සුදු වර්ණය", colorHex: ["#FFFFFF"],
                    luckyMonth: "මැයි", obstacleMonth: "නොවැම්බර්"
                },
                8: {
                    friend: ["2", "4*", "5"], enemy: ["6*", "9*"],
                    planet: "ශනි", luckyDay: "සෙනසුරාදා", luckyDates: "8, 17, 26",
                    color: "දම් වර්ණය", colorHex: ["#800080"],
                    luckyMonth: "ජනවාරි, පෙබරවාරි, ඔක්තෝබර්*", obstacleMonth: "අප්‍රේල්"
                },
                9: {
                    friend: ["3*", "6"], enemy: ["8*"],
                    planet: "කුජ", luckyDay: "අඟහරුවාදා", luckyDates: "9, 18, 27",
                    color: "රතු වර්ණය", colorHex: ["#FF0000"],
                    luckyMonth: "ජනවාරි*, අප්‍රේල්, නොවැම්බර්", obstacleMonth: "ජූලි"
                }
            };

            // 3. Day of Week Map
            const dayOfWeekMap = {
                0: { name: "ඉරිදා", num: 1 },        // Sunday
                1: { name: "සඳුදා", num: 2 },        // Monday
                2: { name: "අඟහරුවාදා", num: 9 },   // Tuesday
                3: { name: "බදාදා", num: 5 },        // Wednesday
                4: { name: "බ්‍රහස්පතින්දා", num: 3 }, // Thursday
                5: { name: "සිකුරාදා", num: 6 },     // Friday
                6: { name: "සෙනසුරාදා", num: 8 }     // Saturday
            };

            // 4. Month Map
            const monthMap = {
                1: { name: "ජනවාරි", num: 8 },
                2: { name: "පෙබරවාරි", num: 8 },
                3: { name: "මාර්තු", num: 3 },
                4: { name: "අප්‍රේල්", num: 9 },
                5: { name: "මැයි", num: 6 },
                6: { name: "ජුනි", num: 5 },
                7: { name: "ජූලි", num: 2 },
                8: { name: "අගෝස්තු", num: 1 },
                9: { name: "සැප්තැම්බර්", num: 5 },
                10: { name: "ඔක්තෝබර්", num: 6 },
                11: { name: "නොවැම්බර්", num: 9 },
                12: { name: "දෙසැම්බර්", num: 3 }
            };

            // 5. Lucky Ages (by Destiny Number)
            const luckyAgesMap = {
                1: "10, 19, 28, 37, 46, 55, 64, 73",
                2: "11, 20, 29, 38, 47, 56, 65, 74",
                3: "12, 21, 30, 39, 48, 57, 66, 75",
                4: "10, 19, 28, 37, 46, 55, 64, 73",
                5: "14, 23, 32, 41, 50, 59, 68, 77",
                6: "15, 24, 33, 42, 51, 60, 69, 78",
                7: "16, 25, 34, 43, 52, 61, 70, 79",
                8: "10, 19, 28, 37, 46, 55, 64, 73",
                9: "18, 27, 36, 45, 54, 63, 72, 81"
            };

            // --- DOM ELEMENTS ---
            const birthdateInput = document.getElementById('birthdate');
            const calculateBtn = document.getElementById('calculateBtn');
            const errorMessage = document.getElementById('error-message');
            const resultsDiv = document.getElementById('results');
            const loadingDiv = document.getElementById('loading');
            const copyrightYear = document.getElementById('year');

            // Result Spans
            const dobDisplay = document.getElementById('dob-display');
            const destinyNum = document.getElementById('destiny-num');
            const personalNum = document.getElementById('personal-num');
            const description = document.getElementById('description');
            const birthDay = document.getElementById('birth-day');
            const birthMonth = document.getElementById('birth-month');
            const friendNums = document.getElementById('friend-nums');
            const enemyNums = document.getElementById('enemy-nums');
            const planet = document.getElementById('planet');
            const luckyDay = document.getElementById('lucky-day');
            const luckyDates = document.getElementById('lucky-dates');
            const luckyColor = document.getElementById('lucky-color');
            const luckyAges = document.getElementById('lucky-ages');
            const luckyMonth = document.getElementById('lucky-month');
            const obstacleMonth = document.getElementById('obstacle-month');

            // --- HELPER FUNCTIONS ---

            /**
             * Reduces a number or string of digits to a single digit (1-9).
             * e.g., "1975" -> 22 -> 4
             * e.g., 28 -> 10 -> 1
             */
            function reduceToSingleDigit(num) {
                let n = String(num);
                while (n.length > 1) {
                    let sum = n.split('').reduce((acc, digit) => acc + parseInt(digit), 0);
                    n = String(sum);
                }
                return parseInt(n);
            }

            /**
             * Formats an array of friend/enemy numbers into styled spans.
             */
            function formatNumbers(numArray, type) {
                return numArray.map(num => {
                    const hasStar = num.includes('*');
                    const cleanNum = num.replace('*', '');
                    let className = '';
                    
                    if (type === 'friend') {
                        className = hasStar ? 'friend-best' : 'friend-normal';
                    } else { // type === 'enemy'
                        className = hasStar ? 'enemy-worst' : 'enemy-normal';
                    }
                    
                    return `<span class="num-badge ${className}">${cleanNum}</span>`;
                }).join(' ');
            }

            /**
             * Formats lucky colors with text and color swatches.
             */
            function formatColors(colorText, colorHexArray) {
                luckyColor.innerHTML = ''; // Clear previous
                luckyColor.appendChild(document.createTextNode(colorText + ' '));
                
                colorHexArray.forEach(hex => {
                    const swatch = document.createElement('span');
                    swatch.className = 'color-swatch';
                    // Special case for white
                    if (hex === '#FFFFFF') {
                        swatch.style.border = '1px solid #ccc';
                    }
                    swatch.style.backgroundColor = hex;
                    luckyColor.appendChild(swatch);
                });
            }

            // --- INITIALIZATION ---

            // Set default date to today
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            birthdateInput.value = `${yyyy}-${mm}-${dd}`;

            // Set copyright year
            copyrightYear.textContent = yyyy;

            // --- EVENT LISTENER ---
            calculateBtn.addEventListener('click', () => {
                const dateValue = birthdateInput.value;

                // 1. Validation
                if (!dateValue) {
                    errorMessage.textContent = 'කරුණාකර වලංගු උපන් දිනයක් ඇතුළත් කරන්න.';
                    resultsDiv.classList.remove('visible');
                    return;
                }
                errorMessage.textContent = '';

                // Show loading
                loadingDiv.style.display = 'block';
                resultsDiv.classList.remove('visible');

                // Simulate processing time for better UX
                setTimeout(() => {
                    // 2. Get Date Components
                    const date = new Date(dateValue);
                    const yearVal = date.getFullYear();
                    const monthVal = date.getMonth() + 1; // 1-12
                    const dayVal = date.getDate(); // 1-31
                    const dayOfWeekIndex = date.getDay(); // 0-6

                    // 3. Calculations
                    // දෛව අංකය (Destiny Number)
                    const fullDateStr = `${yearVal}${monthVal}${dayVal}`;
                    const destinyNumber = reduceToSingleDigit(fullDateStr);

                    // පුද්ගලික අංකය (Personal Number)
                    const personalNumber = reduceToSingleDigit(dayVal);

                    // 4. Get Data from Maps
                    const dayData = dayOfWeekMap[dayOfWeekIndex];
                    const monthData = monthMap[monthVal];
                    const combinedDesc = descriptions[destinyNumber][personalNumber];
                    const details = personalDetails[personalNumber];
                    const ages = luckyAgesMap[destinyNumber];

                    // 5. Populate Results
                    dobDisplay.textContent = dateValue.replace(/-/g, '.');
                    
                    destinyNum.textContent = destinyNumber;
                    personalNum.textContent = personalNumber;
                    
                    description.textContent = combinedDesc;
                    
                    birthDay.textContent = `${dayData.name} (${dayData.num})`;
                    birthMonth.textContent = `${monthData.name} (${monthData.num})`;
                    
                    friendNums.innerHTML = formatNumbers(details.friend, 'friend');
                    enemyNums.innerHTML = formatNumbers(details.enemy, 'enemy');
                    
                    planet.textContent = details.planet;
                    luckyDay.textContent = details.luckyDay;
                    luckyDates.textContent = details.luckyDates;
                    luckyAges.textContent = ages;
                    luckyMonth.textContent = details.luckyMonth;
                    obstacleMonth.textContent = details.obstacleMonth;
                    
                    formatColors(details.color, details.colorHex);

                    // Hide loading and show results
                    loadingDiv.style.display = 'none';
                    resultsDiv.classList.add('visible');
                }, 800); // 800ms delay for better UX
            });
        });
    </script>
</body>
</html>